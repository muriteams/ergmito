<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exponential Random Graph Models for Small Networks • ergmito</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Exponential Random Graph Models for Small Networks">
<meta property="og:description" content="Simulation and estimation of Exponential Random Graph Models (ERGMs)
  for small networks using exact statistics. As a difference from the ergm
  package, ergmito circumvents using Markov-Chain Maximum Likelihood Estimator
  (MC-MLE) and instead uses Maximum Likelihood Estimator (MLE) to fit ERGMs
  for small networks. As exhaustive enumeration is computationally feasible for
  small networks, this R package takes advantage of this and provides tools for
  calculating likelihood functions, and other relevant functions, directly,
  meaning that in many cases both estimation and simulation of ERGMs for
  small networks can be faster and more accurate than simulation-based
  algorithms.">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-70821549-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70821549-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ergmito</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/ergm-equations.html">ERGM equations</a>
    </li>
    <li>
      <a href="articles/extending-ergmito.html">Extending ergmito</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/muriteams/ergmito/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="ergmito-exponential-random-graph-models-for-small-networks" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#ergmito-exponential-random-graph-models-for-small-networks" class="anchor"></a>ergmito: Exponential Random Graph Models for Small Networks <img src="reference/figures/logo.png" align="right" width="180px">
</h1></div>
<!-- [![CRAN status](https://www.r-pkg.org/badges/version/ergmito)](https://cran.r-project.org/package=ergmito) -->
<!-- [![status](https://tinyverse.netlify.com/badge/ergmito)](https://CRAN.R-project.org/package=ergmito) -->

<p>This R package, which has been developed on top of the amazing work that the <a href="https://github.com/statnet">Statnet</a> team has done, implements estimation and simulation methods for Exponential Random Graph Models of small networks, in particular, up to 5 vertices for directed graphs and 7 for undirected networks. In the case of small networks, the calculation of the likelihood of ERGMs becomes computationally feasible, which allows us avoiding approximations and do exact calculation, ultimately obtaining MLEs directly.</p>
<p>Checkout the <a href="#examples">examples section</a>, and specially the <a href="#using-interaction-effects">Using interaction effects</a> example.</p>
<div id="support" class="section level2">
<h2 class="hasAnchor">
<a href="#support" class="anchor"></a>Support</h2>
<p>This material is based upon work support by, or in part by, the U.S. Army Research Laboratory and the U.S. Army Research Office under grant number W911NF-15-1-0577</p>
<p>Computation for the work described in this paper was supported by the University of Southern California’s Center for High-Performance Computing (hpcc.usc.edu).</p>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<p>Vega Yon G (2020). <em>ergmito: Exponential Random Graph Models for Small Networks</em>. R package version 0.3-0, &lt;URL: <a href="https://github.com/muriteams/ergmito" class="uri">https://github.com/muriteams/ergmito</a>&gt;.</p>
<p>Vega Yon G, Slaughter A, de la Haye K (2019). “Exponential Random Graph models for Little Networks.” arXiv:1904.10406.</p>
<p>To see these entries in BibTeX format, use ‘print(<citation>, bibtex=TRUE)’, ‘toBibtex(.)’, or set ‘options(citation.bibtex.max=999)’.</citation></p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="co"># install.packages("devtools")</span>
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu">install_github</span>(<span class="st">"muriteams/ergmito"</span>)</pre></div>
<p>This requires compilation. Windows users can download the latest compiled version from appveyor <a href="https://ci.appveyor.com/project/gvegayon/ergmito/build/artifacts">here</a>. The file to download is the one named <code>ergmito_[version number].zip</code>. Once downloaded, you can install typing the following:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"[path to the zipfile]/ergmito_[version number].zip"</span>, <span class="kw">repos</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></div>
<p>In the case of Mac users, and in particular, those with Mojave version, they may need to install the following <a href="https://github.com/fxcoudert/gfortran-for-macOS/releases" class="uri">https://github.com/fxcoudert/gfortran-for-macOS/releases</a></p>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<div id="quick-run" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-run" class="anchor"></a>Quick run</h2>
<p>In the following example we simulate a small network with 4 vertices and estimate the model parameters using <code>ergm</code> and <code>ergmito</code>. We start by generating the graph</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="co"># Generating a small graph</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ergmito</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ergm</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sna</span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">12123</span>)
<span class="no">n</span>   <span class="kw">&lt;-</span> <span class="fl">4</span>
<span class="no">net</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/rbernoulli.html">rbernoulli</a></span>(<span class="no">n</span>, <span class="kw">p</span> <span class="kw">=</span> <span class="fl">.3</span>)
<span class="fu"><a href="https://rdrr.io/pkg/sna/man/gplot.html">gplot</a></span>(<span class="no">net</span>)</pre></div>
<p><img src="reference/figures/README-net2-1.png" width="80%"></p>
<p>To estimate the model</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">model</span> <span class="kw">&lt;-</span> <span class="no">net</span> ~ <span class="no">edges</span> + <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">istar</a></span>(<span class="fl">2</span>)

<span class="co"># ERGMito (estimation via MLE)</span>
<span class="no">ans_ergmito</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/ergmito.html">ergmito</a></span>(<span class="no">model</span>)</pre></div>
<div class="sourceCode" id="cb5"><pre class="r"><span class="co"># ERGM (estimation via MC-MLE)</span>
<span class="no">ans_ergm</span>  <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm.html">ergm</a></span>(<span class="no">model</span>, <span class="kw">control</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/control.ergm.html">control.ergm</a></span>(
  <span class="kw">MCMC.effectiveSize</span> <span class="kw">=</span> <span class="fl">4000</span>,
  <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">444</span>)
  )

<span class="co"># The ergmito should have a larger value</span>
<span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm.exact.html">ergm.exact</a></span>(<span class="no">ans_ergmito</span>$<span class="no">coef</span>, <span class="no">model</span>) <span class="kw">&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm.exact.html">ergm.exact</a></span>(<span class="no">ans_ergm</span>$<span class="no">coef</span>, <span class="no">model</span>)
<span class="co">#&gt;      [,1]</span>
<span class="co">#&gt; [1,] TRUE</span>

<span class="fu"><a href="https://rdrr.io/pkg/ergm/man/summary.formula.html">summary</a></span>(<span class="no">ans_ergmito</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ERGMito estimates (MLE)</span>
<span class="co">#&gt; This model includes 1 networks.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; formula:</span>
<span class="co">#&gt;   net ~ edges + istar(2)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="co">#&gt; edges  -1.37749    1.00260 -1.3739   0.1695</span>
<span class="co">#&gt; istar2  0.50653    1.32701  0.3817   0.7027</span>
<span class="co">#&gt; AIC: 17.36312    BIC: 18.33294    (Smaller is better.)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ergm/man/summary.formula.html">summary</a></span>(<span class="no">ans_ergm</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ==========================</span>
<span class="co">#&gt; Summary of model fit</span>
<span class="co">#&gt; ==========================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Formula:   net ~ edges + istar(2)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iterations:  2 out of 20 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Monte Carlo MLE Results:</span>
<span class="co">#&gt;        Estimate Std. Error MCMC % z value Pr(&gt;|z|)</span>
<span class="co">#&gt; edges   -1.4110     0.9995      0  -1.412    0.158</span>
<span class="co">#&gt; istar2   0.5607     1.3719      0   0.409    0.683</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      Null Deviance: 16.64  on 12  degrees of freedom</span>
<span class="co">#&gt;  Residual Deviance: 13.35  on 10  degrees of freedom</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; AIC: 17.35    BIC: 18.32    (Smaller is better.)</span></pre></div>
</div>
<div id="estimating-data-with-known-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-data-with-known-parameters" class="anchor"></a>Estimating data with known parameters</h2>
<p>The following example shows the estimation of a dataset that is included in the package, <code>fivenets</code>. This set of five networks was generated using the <code>new_rergmito</code> function which allows creating a function to draw random ERGMs with a fixed set of parameters, in this case, <code>edges = -2.0</code> and <code>nodematch("female") = 2.0</code></p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">fivenets</span>)

<span class="no">model1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/ergmito.html">ergmito</a></span>(<span class="no">fivenets</span> ~ <span class="no">edges</span> + <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>))

<span class="fu"><a href="https://rdrr.io/pkg/ergm/man/summary.formula.html">summary</a></span>(<span class="no">model1</span>) <span class="co"># This data has know parameters equal to -2.0 and 2.0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ERGMito estimates (MLE)</span>
<span class="co">#&gt; This model includes 5 networks.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; formula:</span>
<span class="co">#&gt;   fivenets ~ edges + nodematch("female")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                  Estimate Std. Error z value Pr(&gt;|z|)   </span>
<span class="co">#&gt; edges            -1.70475    0.54356 -3.1363 0.001711 **</span>
<span class="co">#&gt; nodematch.female  1.58697    0.64305  2.4679 0.013592 * </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; AIC: 73.34109    BIC: 77.52978    (Smaller is better.)</span></pre></div>
<p>We can also compute GOF</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="no">fivenets_gof</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/ergmito_gof.html">gof_ergmito</a></span>(<span class="no">model1</span>)
<span class="no">fivenets_gof</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Goodness-of-fit for edges </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       obs min     mean max lower upper lower prob. upper prob.</span>
<span class="co">#&gt; net 1   2   0 3.746607  12     0     6 0.008080856   0.9635261</span>
<span class="co">#&gt; net 2   7   0 3.746607  12     0     6 0.008080856   0.9635261</span>
<span class="co">#&gt; net 3   4   0 3.113122  12     0     6 0.020642814   0.9881036</span>
<span class="co">#&gt; net 4   5   0 5.647059  12     2     8 0.030934588   0.9514908</span>
<span class="co">#&gt; net 5   2   0 3.746607  12     0     6 0.008080856   0.9635261</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Goodness-of-fit for nodematch.female </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       obs min     mean max lower upper lower prob. upper prob.</span>
<span class="co">#&gt; net 1   2   0 2.823530   6     0     5  0.02201716   0.9891396</span>
<span class="co">#&gt; net 2   5   0 2.823530   6     0     5  0.02201716   0.9891396</span>
<span class="co">#&gt; net 3   3   0 1.882353   4     0     3  0.07855507   0.9509584</span>
<span class="co">#&gt; net 4   5   0 5.647059  12     2     8  0.03093459   0.9514908</span>
<span class="co">#&gt; net 5   1   0 2.823530   6     0     5  0.02201716   0.9891396</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Note: Exact confidence intervals where used. This implies that the requestes CI may differ from the one used (see ?gof_ergmito).</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">fivenets_gof</span>)</pre></div>
<p><img src="reference/figures/README-fivenets-gof-1.png" width="80%"></p>
</div>
<div id="fitting-block-diagonal-models" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-block-diagonal-models" class="anchor"></a>Fitting block-diagonal models</h2>
<p>The pooled model can be also compared to a block-diagonal ERGM. The package includes three functions to help with this task: <code>blockdiagonalize</code>, <code>splitnetwork</code>, and <code>ergm_blockdiag</code>.</p>
<div class="sourceCode" id="cb8"><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"fivenets"</span>)

<span class="co"># Stacking matrices together</span>
<span class="no">fivenets_blockdiag</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/blockdiagonalize.html">blockdiagonalize</a></span>(<span class="no">fivenets</span>, <span class="st">"block_id"</span>)
<span class="no">fivenets_blockdiag</span> <span class="co"># It creates the 'block_id' variable</span>
<span class="co">#&gt;  Network attributes:</span>
<span class="co">#&gt;   vertices = 20 </span>
<span class="co">#&gt;   directed = TRUE </span>
<span class="co">#&gt;   hyper = FALSE </span>
<span class="co">#&gt;   loops = FALSE </span>
<span class="co">#&gt;   multiple = FALSE </span>
<span class="co">#&gt;   bipartite = FALSE </span>
<span class="co">#&gt;   total edges= 20 </span>
<span class="co">#&gt;     missing edges= 0 </span>
<span class="co">#&gt;     non-missing edges= 20 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Vertex attribute names: </span>
<span class="co">#&gt;     block_id female name_original vertex.names </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; No edge attributes</span></pre></div>
<div class="sourceCode" id="cb9"><pre class="r"><span class="co"># Fitting the model with ERGM</span>
<span class="no">ans0</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm.html">ergm</a></span>(
  <span class="no">fivenets_blockdiag</span> ~ <span class="no">edges</span> + <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>),
  <span class="kw">constraints</span> <span class="kw">=</span> ~ <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm-constraints.html">blockdiag</a></span>(<span class="st">"block_id"</span>)
  )</pre></div>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">ans1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/blockdiagonalize.html">ergm_blockdiag</a></span>(<span class="no">fivenets</span> ~ <span class="no">edges</span> + <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>))</pre></div>
<div class="sourceCode" id="cb11"><pre class="r"><span class="co"># Now with ergmito</span>
<span class="no">ans2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/ergmito.html">ergmito</a></span>(<span class="no">fivenets</span> ~ <span class="no">edges</span> + <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>))

<span class="co"># All three are equivalent</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(
  <span class="kw">ergm</span>           <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">ans0</span>),
  <span class="kw">ergm_blockdiag</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">ans1</span>),
  <span class="kw">ergmito</span>        <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">ans2</span>)
)
<span class="co">#&gt;                       ergm ergm_blockdiag   ergmito</span>
<span class="co">#&gt; edges            -1.704748      -1.704748 -1.704748</span>
<span class="co">#&gt; nodematch.female  1.586965       1.586965  1.586965</span></pre></div>
<p>The benefit of ergmito:</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="no">t_ergm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm.html">ergm</a></span>(
  <span class="no">fivenets_blockdiag</span> ~ <span class="no">edges</span> + <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>) + <span class="no">ttriad</span>,
  <span class="kw">constraints</span> <span class="kw">=</span> ~ <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm-constraints.html">blockdiag</a></span>(<span class="st">"block_id"</span>)
  ))
<span class="no">t_ergmito</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(
  <span class="fu"><a href="reference/ergmito.html">ergmito</a></span>(<span class="no">fivenets</span> ~ <span class="no">edges</span> + <span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>)  + <span class="no">ttriad</span>)
  )</pre></div>
<div class="sourceCode" id="cb13"><pre class="r"><span class="co"># Relative elapsed time</span>
(<span class="no">t_ergm</span>/<span class="no">t_ergmito</span>)[<span class="fl">3</span>]
<span class="co">#&gt;  elapsed </span>
<span class="co">#&gt; 110.6667</span></pre></div>
</div>
<div id="fitting-a-large-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-a-large-model" class="anchor"></a>Fitting a large model</h2>
<p>Suppose that we have a large sample of small networks (ego from Facebook, Twitter, etc.), 20,000 which account for 80,000 vertices:</p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="no">bignet</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/rbernoulli.html">rbernoulli</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">3</span>:<span class="fl">5</span>, <span class="fl">20000</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="co"># Number of vertices</span>
<span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">sum</a></span>(<span class="fu"><a href="reference/nvertex.html">nvertex</a></span>(<span class="no">bignet</span>))
<span class="co">#&gt; [1] 80089</span></pre></div>
<p>We can fit this model in a memory efficient way.</p>
<div class="sourceCode" id="cb15"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(<span class="no">ans0</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/ergmito.html">ergmito</a></span>(<span class="no">bignet</span> ~ <span class="no">edges</span> + <span class="no">mutual</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   2.971   0.021   2.991</span>
<span class="fu"><a href="https://rdrr.io/pkg/ergm/man/summary.formula.html">summary</a></span>(<span class="no">ans0</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ERGMito estimates</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; formula:  bignet ~ edges + mutual </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="co">#&gt; edges  -0.0020193  0.0068675 -0.2940   0.7687</span>
<span class="co">#&gt; mutual -0.0018160  0.0112247 -0.1618   0.8715</span>
<span class="co">#&gt; AIC: 352097.2    BIC: 352118.1    (Smaller is better.)</span></pre></div>
</div>
<div id="using-interaction-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#using-interaction-effects" class="anchor"></a>Using interaction effects</h2>
<p>One advantage of using exact statistics is the fact that we have significantly more flexibility when it comes to specifying sufficient statistics. Just like one would do when working with Generalized Linear Models in R (the “glm” function), users can alter the specified formula adding arbitrary offsets (using the offset function), or creating new terms by using the “I” function. In this brief example, where we will estimate a model that includes networks of size four and five, we will add an interaction effect between the edge-count statistic and the indicator function that equals one if the network is of size 5. This way, while poling the data, we will still be able to obtain different edge-count estimates depending on the number of vertices in the graph.</p>
<div class="sourceCode" id="cb16"><pre class="r"><span class="co"># Simulating networks of different sizes</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">12344</span>)
<span class="no">nets</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/rbernoulli.html">rbernoulli</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">4</span>, <span class="fl">10</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">5</span>, <span class="fl">10</span>)), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">.2</span>, <span class="fl">10</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">.1</span>, <span class="fl">10</span>)))</pre></div>
<p>Fitting an ergmito under the Bernoulli model</p>
<div class="sourceCode" id="cb17"><pre class="r"><span class="no">ans0</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/ergmito.html">ergmito</a></span>(<span class="no">nets</span> ~ <span class="no">edges</span>)
<span class="fu"><a href="https://rdrr.io/pkg/ergm/man/summary.formula.html">summary</a></span>(<span class="no">ans0</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ERGMito estimates (MLE)</span>
<span class="co">#&gt; This model includes 20 networks.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; formula:</span>
<span class="co">#&gt;   nets ~ edges</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Estimate Std. Error z value  Pr(&gt;|z|)    </span>
<span class="co">#&gt; edges -1.68640    0.15396 -10.954 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; AIC: 279.3753    BIC: 283.1436    (Smaller is better.)</span></pre></div>
<p>Fitting the model including a reference term for networks of size 5. Notice that the variable -n- and other graph attributes can be used with -model_update-.</p>
<div class="sourceCode" id="cb18"><pre class="r"><span class="no">ans1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/ergmito.html">ergmito</a></span>(<span class="no">nets</span> ~ <span class="no">edges</span>, <span class="kw">model_update</span> <span class="kw">=</span> ~ <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(<span class="no">edges</span> * (<span class="no">n</span> <span class="kw">==</span> <span class="fl">5</span>)))
<span class="fu"><a href="https://rdrr.io/pkg/ergm/man/summary.formula.html">summary</a></span>(<span class="no">ans1</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ERGMito estimates (MLE)</span>
<span class="co">#&gt; This model includes 20 networks.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; formula:</span>
<span class="co">#&gt;   nets ~ edges + I(edges * (n == 5))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                     Estimate Std. Error z value  Pr(&gt;|z|)    </span>
<span class="co">#&gt; edges               -1.18958    0.21583 -5.5116 3.556e-08 ***</span>
<span class="co">#&gt; I(edges * (n == 5)) -0.90116    0.31250 -2.8837   0.00393 ** </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; AIC: 272.9916    BIC: 280.5282    (Smaller is better.)</span></pre></div>
<p>The resulting parameter for the edge-count is smaller for networks of size five</p>
<div class="sourceCode" id="cb19"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">ans1</span>)[<span class="fl">1</span>])
<span class="co">#&gt;     edges </span>
<span class="co">#&gt; 0.2333333</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">ans1</span>)))
<span class="co">#&gt; [1] 0.11</span></pre></div>
<p>We can see that in this case the difference in edge-count matters.</p>
<div class="sourceCode" id="cb20"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lmtest</span>)
<span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span>(<span class="no">ans0</span>, <span class="no">ans1</span>)
<span class="co">#&gt; Likelihood ratio test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: nets ~ edges</span>
<span class="co">#&gt; Model 2: nets ~ edges + I(edges * (n == 5))</span>
<span class="co">#&gt;   #Df  LogLik Df  Chisq Pr(&gt;Chisq)   </span>
<span class="co">#&gt; 1   1 -138.69                        </span>
<span class="co">#&gt; 2   2 -134.50  1 8.3837   0.003786 **</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></div>
</div>
</div>
<div id="contributing" class="section level1">
<h1 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h1>
<p>Please note that the ‘ergmito’ project is released with a <a href="CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=ergmito">https://​cloud.r-project.org/​package=ergmito</a>
</li>
<li>Browse source code at <br><a href="https://github.com/muriteams/ergmito/">https://​github.com/​muriteams/​ergmito/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/muriteams/ergmito/issues">https://​github.com/​muriteams/​ergmito/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing ergmito</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>George Vega Yon <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-3171-0844" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Army Research Laboratory and the U.S. Army Research Office <br><small class="roles"> Funder </small>  <br><small>(Grant Number W911NF-15-1-0577)</small>
</li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a></li>
<li><a href="https://travis-ci.org/muriteams/ergmito"><img src="https://travis-ci.org/muriteams/ergmito.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://ci.appveyor.com/project/gvegayon/ergmito"><img src="https://ci.appveyor.com/api/projects/status/nl1irakr2g6y6w03?svg=true" alt="AppVeyor Build status"></a></li>
<li><a href="https://codecov.io/gh/muriteams/ergmito"><img src="https://codecov.io/gh/muriteams/ergmito/branch/master/graph/badge.svg" alt="codecov"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by George Vega Yon, Army Research Laboratory and the U.S. Army Research Office.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
