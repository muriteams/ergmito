<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exponential Random Graph Models for Small Networks • ergmito</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Exponential Random Graph Models for Small Networks">
<meta property="og:description" content="Simulation and estimation of Exponential Random Graph Models (ERGMs)
  for small networks using exact statistics. As a difference from the ergm
  package, ergmito circumvents using Markov-Chain Maximum Likelihood Estimator
  (MC-MLE) and instead uses Maximum Likelihood Estimator (MLE) to fit ERGMs
  for small networks. As exhaustive enumeration is computationally feasible for
  small networks, this R package takes advantage of this and provides tools for
  calculating likelihood functions, and other relevant functions, directly,
  meaning that in many cases both estimation and simulation of ERGMs for
  small networks can be faster and more accurate than simulation-based
  algorithms.">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ergmito</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/ergm-equations.html">ERGM equations</a>
    </li>
    <li>
      <a href="articles/extending-ergmito.html">Extending ergmito</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/muriteams/ergmito">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="ergmito-exponential-random-graph-models-for-small-networks" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#ergmito-exponential-random-graph-models-for-small-networks" class="anchor"></a>ergmito: Exponential Random Graph Models for Small Networks <img src="reference/figures/logo.png" align="right" width="180px">
</h1></div>
<!-- [![CRAN status](https://www.r-pkg.org/badges/version/ergmito)](https://cran.r-project.org/package=ergmito) -->
<!-- [![status](https://tinyverse.netlify.com/badge/ergmito)](https://CRAN.R-project.org/package=ergmito) -->
<p><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a> <a href="https://travis-ci.org/muriteams/ergmito"><img src="https://travis-ci.org/muriteams/ergmito.svg?branch=master" alt="Travis build status"></a> <a href="https://ci.appveyor.com/project/gvegayon/ergmito"><img src="https://ci.appveyor.com/api/projects/status/nl1irakr2g6y6w03?svg=true" alt="AppVeyor Build status"></a> <a href="https://codecov.io/gh/muriteams/ergmito"><img src="https://codecov.io/gh/muriteams/ergmito/branch/master/graph/badge.svg" alt="codecov"></a> <img src="http://cranlogs.r-pkg.org/badges/grand-total/ergmito"></p>
<p>This R package, which has been developed on top of the amazing work that the <a href="https://github.com/statnet">Statnet</a> team has done, implements estimation and simulation methods for Exponential Random Graph Models of small networks, in particular, less than 7 nodes. In the case of small networks, the calculation of the likelihood of ERGMs becomes computationally feasible, which allows us avoiding approximations and do exact calculation, ultimately obtaining MLEs directly.</p>
<div id="support" class="section level2">
<h2 class="hasAnchor">
<a href="#support" class="anchor"></a>Support</h2>
<p>This material is based upon work support by, or in part by, the U.S. Army Research Laboratory and the U.S. Army Research Office under grant number W911NF-15-1-0577</p>
<p>Computation for the work described in this paper was supported by the University of Southern California’s Center for High-Performance Computing (hpcc.usc.edu).</p>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<p>Vega Yon G (2020). <em>ergmito: Exponential Random Graph Models for Small Networks</em>. R package version 0.2-999, &lt;URL: <a href="https://github.com/muriteams/ergmito" class="uri">https://github.com/muriteams/ergmito</a>&gt;.</p>
<p>Vega Yon G, Slaughter A, de la Haye K (2019). “Exponential Random Graph models for Little Networks.” arXiv:1904.10406.</p>
<p>To see these entries in BibTeX format, use ‘print(<citation>, bibtex=TRUE)’, ‘toBibtex(.)’, or set ‘options(citation.bibtex.max=999)’.</citation></p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"muriteams/ergmito"</span>)</a></code></pre></div>
<p>This requires compilation. Windows users can download the latest compiled version from appveyor <a href="https://ci.appveyor.com/project/gvegayon/ergmito/build/artifacts">here</a>. The file to download is the one named <code>ergmito_[version number].zip</code>. Once downloaded, you can install typing the following:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"[path to the zipfile]/ergmito_[version number].zip"</span>, <span class="dt">repos =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>In the case of Mac users, and in particular, those with Mojave version, they may need to install the following <a href="https://github.com/fxcoudert/gfortran-for-macOS/releases" class="uri">https://github.com/fxcoudert/gfortran-for-macOS/releases</a></p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>In the following example we simulate a small network with 4 vertices and estimate the model parameters using <code>ergm</code> and <code>ergmito</code>. We start by generating the graph</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Generating a small graph</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ergmito)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ergm)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sna)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">12123</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">n   &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">net &lt;-<span class="st"> </span><span class="kw"><a href="reference/rbernoulli.html">rbernoulli</a></span>(n, <span class="dt">p =</span> <span class="fl">.3</span>)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/pkg/sna/man/gplot.html">gplot</a></span>(net)</a></code></pre></div>
<p><img src="reference/figures/README-net2-1.png" width="80%"></p>
<p>To estimate the model</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">model &lt;-<span class="st"> </span>net <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">istar</a></span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># ERGMito (estimation via MLE)</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">ans_ergmito &lt;-<span class="st"> </span><span class="kw"><a href="reference/ergmito.html">ergmito</a></span>(model)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># ERGM (estimation via MC-MLE)</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">ans_ergm  &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm.html">ergm</a></span>(model, <span class="dt">control =</span> <span class="kw"><a href="https://rdrr.io/pkg/ergm/man/control.ergm.html">control.ergm</a></span>(</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  <span class="dt">MCMC.effectiveSize =</span> <span class="dv">4000</span>,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  <span class="dt">seed =</span> <span class="dv">444</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co"># The ergmito should have a larger value</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm.exact.html">ergm.exact</a></span>(ans_ergmito<span class="op">$</span>coef, model) <span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm.exact.html">ergm.exact</a></span>(ans_ergm<span class="op">$</span>coef, model)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; [1,] TRUE</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/summary.formula.html">summary</a></span>(ans_ergmito)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; ERGMito estimates</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; formula:  net ~ edges + istar(2) </span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt;        Estimate Std. Error z value Pr(&gt;|z|)</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; edges  -1.37749    1.00260 -1.3739   0.1695</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; istar2  0.50653    1.32701  0.3817   0.7027</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; AIC: 17.36312    BIC: 18.33294    (Smaller is better.)</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/summary.formula.html">summary</a></span>(ans_ergm)</a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt; ==========================</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt; Summary of model fit</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt; ==========================</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="co">#&gt; Formula:   net ~ edges + istar(2)</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="co">#&gt; Iterations:  2 out of 20 </span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-32" data-line-number="32"><span class="co">#&gt; Monte Carlo MLE Results:</span></a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="co">#&gt;        Estimate Std. Error MCMC % z value Pr(&gt;|z|)</span></a>
<a class="sourceLine" id="cb5-34" data-line-number="34"><span class="co">#&gt; edges   -1.4110     0.9995      0  -1.412    0.158</span></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="co">#&gt; istar2   0.5607     1.3719      0   0.409    0.683</span></a>
<a class="sourceLine" id="cb5-36" data-line-number="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-37" data-line-number="37"><span class="co">#&gt;      Null Deviance: 16.64  on 12  degrees of freedom</span></a>
<a class="sourceLine" id="cb5-38" data-line-number="38"><span class="co">#&gt;  Residual Deviance: 13.35  on 10  degrees of freedom</span></a>
<a class="sourceLine" id="cb5-39" data-line-number="39"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb5-40" data-line-number="40"><span class="co">#&gt; AIC: 17.35    BIC: 18.32    (Smaller is better.)</span></a></code></pre></div>
</div>
<div id="estimating-data-with-known-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-data-with-known-parameters" class="anchor"></a>Estimating data with known parameters</h2>
<p>The following example shows the estimation of a dataset that is included in the package, <code>fivenets</code>. This set of five networks was generated using the <code>new_rergmito</code> function which allows creating a function to draw random ERGMs with a fixed set of parameters, in this case, <code>edges = -2.0</code> and <code>nodematch("female") = 2.0</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(fivenets)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">model1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/ergmito.html">ergmito</a></span>(fivenets <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>))</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/summary.formula.html">summary</a></span>(model1) <span class="co"># This data has know parameters equal to -2.0 and 2.0</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; ERGMito estimates</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; formula:  fivenets ~ edges + nodematch("female") </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;                  Estimate Std. Error z value Pr(&gt;|z|)   </span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; edges            -1.70475    0.54356 -3.1363 0.001711 **</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; nodematch.female  1.58697    0.64305  2.4679 0.013592 * </span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; AIC: 73.34109    BIC: 77.52978    (Smaller is better.)</span></a></code></pre></div>
<p>We can also compute GOF</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">fivenets_gof &lt;-<span class="st"> </span><span class="kw"><a href="reference/ergmito_gof.html">gof_ergmito</a></span>(model1)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">fivenets_gof</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; Goodness-of-fit for edges </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;       obs min mean max lower upper lower prob. upper prob.</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; net 1   2   0  3.7  12     0     6      0.0081        0.96</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; net 2   7   0  3.7  12     0     6      0.0081        0.96</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; net 3   4   0  3.1  12     0     6      0.0206        0.99</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; net 4   5   0  5.6  12     2     8      0.0309        0.95</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; net 5   2   0  3.7  12     0     6      0.0081        0.96</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; Goodness-of-fit for nodematch.female </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt;       obs min mean max lower upper lower prob. upper prob.</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; net 1   2   0  2.8   6     0     5       0.022        0.99</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; net 2   5   0  2.8   6     0     5       0.022        0.99</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt; net 3   3   0  1.9   4     0     3       0.079        0.95</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt; net 4   5   0  5.6  12     2     8       0.031        0.95</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt; net 5   1   0  2.8   6     0     5       0.022        0.99</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; Note: Exact confidence intervals where used. This implies that the requestes CI may differ from the one used (see ?gof_ergmito).</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(fivenets_gof)</a></code></pre></div>
<p><img src="reference/figures/README-fivenets-gof-1.png" width="80%"></p>
</div>
<div id="fitting-block-diagonal-models" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-block-diagonal-models" class="anchor"></a>Fitting block-diagonal models</h2>
<p>The pooled model can be also compared to a block-diagonal ERGM. The package includes three functions to help with this task: <code>blockdiagonalize</code>, <code>splitnetwork</code>, and <code>ergm_blockdiag</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"fivenets"</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># Stacking matrices together</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">fivenets_blockdiag &lt;-<span class="st"> </span><span class="kw"><a href="reference/blockdiagonalize.html">blockdiagonalize</a></span>(fivenets, <span class="st">"block_id"</span>)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">fivenets_blockdiag <span class="co"># It creates the 'block_id' variable</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;  Network attributes:</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;   vertices = 20 </span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt;   directed = TRUE </span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt;   hyper = FALSE </span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;   loops = FALSE </span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;   multiple = FALSE </span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;   bipartite = FALSE </span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;   total edges= 20 </span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;     missing edges= 0 </span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt;     non-missing edges= 20 </span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt;  Vertex attribute names: </span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt;     block_id female name_original vertex.names </span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt; No edge attributes</span></a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Fitting the model with ERGM</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">ans0 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm.html">ergm</a></span>(</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  fivenets_blockdiag <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>),</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="dt">constraints =</span> <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm-constraints.html">blockdiag</a></span>(<span class="st">"block_id"</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  )</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">ans1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/blockdiagonalize.html">ergm_blockdiag</a></span>(fivenets <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>))</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Now with ergmito</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">ans2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/ergmito.html">ergmito</a></span>(fivenets <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>))</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co"># All three are equivalent</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="dt">ergm           =</span> <span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(ans0),</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">  <span class="dt">ergm_blockdiag =</span> <span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(ans1),</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">  <span class="dt">ergmito        =</span> <span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(ans2)</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt;                       ergm ergm_blockdiag   ergmito</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt; edges            -1.704748      -1.704748 -1.704748</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; nodematch.female  1.586965       1.586965  1.586965</span></a></code></pre></div>
<p>The benefit of ergmito:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">t_ergm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm.html">ergm</a></span>(</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">  fivenets_blockdiag <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>) <span class="op">+</span><span class="st"> </span>ttriad,</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  <span class="dt">constraints =</span> <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm-constraints.html">blockdiag</a></span>(<span class="st">"block_id"</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">  ))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">t_ergmito &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">  <span class="kw"><a href="reference/ergmito.html">ergmito</a></span>(fivenets <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">nodematch</a></span>(<span class="st">"female"</span>)  <span class="op">+</span><span class="st"> </span>ttriad)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">  )</a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Relative elapsed time</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">(t_ergm<span class="op">/</span>t_ergmito)[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt;  elapsed </span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; 110.6667</span></a></code></pre></div>
</div>
<div id="fitting-a-large-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-a-large-model" class="anchor"></a>Fitting a large model</h2>
<p>Suppose that we have a large sample of small networks (ego from Facebook, Twitter, etc.), 20,000 which account for 80,000 vertices:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">bignet &lt;-<span class="st"> </span><span class="kw"><a href="reference/rbernoulli.html">rbernoulli</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">20000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co"># Number of vertices</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/ergm-terms.html">sum</a></span>(<span class="kw"><a href="reference/nvertex.html">nvertex</a></span>(bignet))</a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; [1] 80089</span></a></code></pre></div>
<p>We can fit this model in a memory efficient way.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(ans0 &lt;-<span class="st"> </span><span class="kw"><a href="reference/ergmito.html">ergmito</a></span>(bignet <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span>mutual))</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt;   8.208   0.037   8.251</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/pkg/ergm/man/summary.formula.html">summary</a></span>(ans0)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; ERGMito estimates</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt; formula:  bignet ~ edges + mutual </span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt;          Estimate Std. Error z value Pr(&gt;|z|)</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt; edges  -0.0021702  0.0068674 -0.3160    0.752</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt; mutual -0.0015521  0.0112247 -0.1383    0.890</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">#&gt; AIC: 352097.2    BIC: 352118.1    (Smaller is better.)</span></a></code></pre></div>
</div>
</div>
<div id="contributing" class="section level1">
<h1 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h1>
<p>Please note that the ‘ergmito’ project is released with a <a href="CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/muriteams/ergmito">https://​github.com/​muriteams/​ergmito</a>
</li>
<li>Report a bug at <br><a href="https://github.com/muriteams/ergmito/issues">https://​github.com/​muriteams/​ergmito/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing ergmito</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>George Vega Yon <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-3171-0844" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
<li>Army Research Laboratory and the U.S. Army Research Office <br><small class="roles"> Funder </small>  <br><small>(Grant Number W911NF-15-1-0577)</small>
</li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by George Vega Yon, Army Research Laboratory and the U.S. Army Research Office.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
